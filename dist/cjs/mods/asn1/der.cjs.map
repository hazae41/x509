{"version":3,"file":"der.cjs","sources":["../../../../src/mods/asn1/der.ts"],"sourcesContent":["import { Binary } from \"libs/binary/binary.js\";\nimport { Constructed } from \"mods/asn1/constructed/constructed.js\";\nimport { Integer } from \"mods/asn1/integer/integer.js\";\nimport { Length } from \"mods/asn1/length/length.js\";\nimport { ToStringable, Typed } from \"mods/asn1/object.js\";\nimport { Sequence } from \"mods/asn1/sequence/sequence.js\";\nimport { Type } from \"mods/asn1/type/type.js\";\nimport { Unknown } from \"mods/asn1/unknown/unknown.js\";\n\nexport namespace DER {\n\n  export function parse(binary: Binary): Typed & ToStringable {\n    const start = binary.offset\n\n    const type = Type.fromDER(binary)\n    const length = Length.fromDER(binary)\n\n    const content = binary.offset\n    binary.offset = start\n\n    if (type.equals(Sequence.type))\n      return Sequence.fromDER(binary, parse)\n    if (type.equals(Integer.type))\n      return Integer.fromDER(binary)\n\n    if (type.clazz === Type.clazzes.context) {\n      if (type.constructed)\n        return Constructed.fromDER(binary, parse)\n    }\n\n    binary.offset = content\n    binary.offset += length.value\n\n    return new Unknown(type)\n  }\n\n}"],"names":["DER","type","Type","length","Length","Sequence","Integer","Constructed","Unknown"],"mappings":";;;;;;;;;AASiBA,qBA2BhB;AA3BD,CAAA,UAAiB,GAAG,EAAA;IAElB,SAAgB,KAAK,CAAC,MAAc,EAAA;AAClC,QAAA,MAAM,KAAK,GAAG,MAAM,CAAC,MAAM,CAAA;QAE3B,MAAMC,MAAI,GAAGC,SAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;QACjC,MAAMC,QAAM,GAAGC,aAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;AAErC,QAAA,MAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAA;AAC7B,QAAA,MAAM,CAAC,MAAM,GAAG,KAAK,CAAA;AAErB,QAAA,IAAIH,MAAI,CAAC,MAAM,CAACI,iBAAQ,CAAC,IAAI,CAAC;YAC5B,OAAOA,iBAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;AACxC,QAAA,IAAIJ,MAAI,CAAC,MAAM,CAACK,eAAO,CAAC,IAAI,CAAC;AAC3B,YAAA,OAAOA,eAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;QAEhC,IAAIL,MAAI,CAAC,KAAK,KAAKC,SAAI,CAAC,OAAO,CAAC,OAAO,EAAE;YACvC,IAAID,MAAI,CAAC,WAAW;gBAClB,OAAOM,uBAAW,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;AAC5C,SAAA;AAED,QAAA,MAAM,CAAC,MAAM,GAAG,OAAO,CAAA;AACvB,QAAA,MAAM,CAAC,MAAM,IAAIJ,QAAM,CAAC,KAAK,CAAA;AAE7B,QAAA,OAAO,IAAIK,eAAO,CAACP,MAAI,CAAC,CAAA;KACzB;AAvBe,IAAA,GAAA,CAAA,KAAK,QAuBpB,CAAA;AAEH,CAAC,EA3BgBD,WAAG,GAAHA,WAAG,KAAHA,WAAG,GA2BnB,EAAA,CAAA,CAAA;;"}