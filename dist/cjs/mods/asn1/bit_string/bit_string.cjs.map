{"version":3,"file":"bit_string.cjs","sources":["../../../../../src/mods/asn1/bit_string/bit_string.ts"],"sourcesContent":["import { Binary } from \"libs/binary/binary.js\";\nimport { Buffers } from \"libs/buffers/buffers.js\";\nimport { Length } from \"mods/asn1/length/length.js\";\nimport { Type } from \"mods/asn1/type/type.js\";\n\nexport class BitString {\n  readonly class = BitString\n\n  static type = new Type(\n    Type.clazzes.UNIVERSAL,\n    Type.wraps.PRIMITIVE,\n    Type.tags.BIT_STRING)\n\n  constructor(\n    readonly padding: number,\n    readonly buffer: Buffer\n  ) { }\n\n  get type() {\n    return this.class.type\n  }\n\n  toString() {\n    const binary = Buffers.toBinary(this.buffer)\n    return `BITSTRING ${binary.slice(0, binary.length - this.padding)}`\n  }\n\n  static fromDER(binary: Binary) {\n    const type = Type.fromDER(binary)\n\n    if (!this.type.equals(type))\n      throw new Error(`Invalid type`)\n\n    const length = Length.fromDER(binary)\n    const content = binary.offset\n\n    const padding = binary.readUint8()\n    const buffer = binary.read(length.value - 1)\n\n    if (binary.offset - content !== length.value)\n      throw new Error(`Invalid length`)\n\n    return new this(padding, buffer)\n  }\n}"],"names":["Buffers","type","Type","length","Length"],"mappings":";;;;;;MAKa,SAAS,CAAA;IAQpB,WACW,CAAA,OAAe,EACf,MAAc,EAAA;QADd,IAAO,CAAA,OAAA,GAAP,OAAO,CAAQ;QACf,IAAM,CAAA,MAAA,GAAN,MAAM,CAAQ;QAThB,IAAK,CAAA,KAAA,GAAG,SAAS,CAAA;KAUrB;AAEL,IAAA,IAAI,IAAI,GAAA;AACN,QAAA,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAA;KACvB;IAED,QAAQ,GAAA;QACN,MAAM,MAAM,GAAGA,eAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;AAC5C,QAAA,OAAO,aAAa,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAA;KACpE;IAED,OAAO,OAAO,CAAC,MAAc,EAAA;QAC3B,MAAMC,MAAI,GAAGC,SAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;QAEjC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAACD,MAAI,CAAC;AACzB,YAAA,MAAM,IAAI,KAAK,CAAC,CAAA,YAAA,CAAc,CAAC,CAAA;QAEjC,MAAME,QAAM,GAAGC,aAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;AACrC,QAAA,MAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAA;AAE7B,QAAA,MAAM,OAAO,GAAG,MAAM,CAAC,SAAS,EAAE,CAAA;AAClC,QAAA,MAAM,MAAM,GAAG,MAAM,CAAC,IAAI,CAACD,QAAM,CAAC,KAAK,GAAG,CAAC,CAAC,CAAA;QAE5C,IAAI,MAAM,CAAC,MAAM,GAAG,OAAO,KAAKA,QAAM,CAAC,KAAK;AAC1C,YAAA,MAAM,IAAI,KAAK,CAAC,CAAA,cAAA,CAAgB,CAAC,CAAA;AAEnC,QAAA,OAAO,IAAI,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAA;KACjC;;AAnCM,SAAI,CAAA,IAAA,GAAG,IAAID,SAAI,CACpBA,SAAI,CAAC,OAAO,CAAC,SAAS,EACtBA,SAAI,CAAC,KAAK,CAAC,SAAS,EACpBA,SAAI,CAAC,IAAI,CAAC,UAAU,CAAC;;;;"}