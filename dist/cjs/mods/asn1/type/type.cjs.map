{"version":3,"file":"type.cjs","sources":["../../../../../src/mods/asn1/type/type.ts"],"sourcesContent":["import { Binary } from \"libs/binary/binary.js\";\nimport { Bitset } from \"libs/bitset/bitset.js\";\n\nexport class Type {\n  readonly class = Type\n\n  static clazzes = {\n    UNIVERSAL: 0,\n    APPLICATION: 1,\n    CONTEXT: 2,\n    PRIVATE: 3\n  } as const\n\n  static wraps = {\n    PRIMITIVE: false,\n    CONSTRUCTED: true\n  } as const\n\n  static tags = {\n    INTEGER: 2,\n    BIT_STRING: 3,\n    OCTET_STRING: 4,\n    OBJECT_IDENTIFIER: 6,\n    UTF8_STRING: 12,\n    SEQUENCE: 16,\n    SET: 17,\n    PRINTABLE_STRING: 19\n  } as const\n\n  constructor(\n    readonly clazz: number,\n    readonly wrap: boolean,\n    readonly tag: number\n  ) { }\n\n  equals(other: Type) {\n    if (this.clazz !== other.clazz)\n      return false\n    if (this.wrap !== other.wrap)\n      return false\n    if (this.tag !== other.tag)\n      return false\n    return true\n  }\n\n  static fromDER(binary: Binary) {\n    const type = binary.readUint8()\n    const bitset = new Bitset(type, 8)\n\n    const clazz = bitset.first(2)\n    const constructed = bitset.get(5)\n    const tag = bitset.last(5)\n\n    if (tag > 30) // TODO\n      throw new Error(`Unimplemented tag`)\n\n    return new this(clazz, constructed, tag)\n  }\n}"],"names":["bitset","Bitset"],"mappings":";;;;MAGa,IAAI,CAAA;AA0Bf,IAAA,WAAA,CACW,KAAa,EACb,IAAa,EACb,GAAW,EAAA;QAFX,IAAK,CAAA,KAAA,GAAL,KAAK,CAAQ;QACb,IAAI,CAAA,IAAA,GAAJ,IAAI,CAAS;QACb,IAAG,CAAA,GAAA,GAAH,GAAG,CAAQ;QA5Bb,IAAK,CAAA,KAAA,GAAG,IAAI,CAAA;KA6BhB;AAEL,IAAA,MAAM,CAAC,KAAW,EAAA;AAChB,QAAA,IAAI,IAAI,CAAC,KAAK,KAAK,KAAK,CAAC,KAAK;AAC5B,YAAA,OAAO,KAAK,CAAA;AACd,QAAA,IAAI,IAAI,CAAC,IAAI,KAAK,KAAK,CAAC,IAAI;AAC1B,YAAA,OAAO,KAAK,CAAA;AACd,QAAA,IAAI,IAAI,CAAC,GAAG,KAAK,KAAK,CAAC,GAAG;AACxB,YAAA,OAAO,KAAK,CAAA;AACd,QAAA,OAAO,IAAI,CAAA;KACZ;IAED,OAAO,OAAO,CAAC,MAAc,EAAA;AAC3B,QAAA,MAAM,IAAI,GAAG,MAAM,CAAC,SAAS,EAAE,CAAA;QAC/B,MAAMA,QAAM,GAAG,IAAIC,aAAM,CAAC,IAAI,EAAE,CAAC,CAAC,CAAA;QAElC,MAAM,KAAK,GAAGD,QAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;QAC7B,MAAM,WAAW,GAAGA,QAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;QACjC,MAAM,GAAG,GAAGA,QAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;AAE1B,QAAA,IAAI,GAAG,GAAG,EAAE;AACV,YAAA,MAAM,IAAI,KAAK,CAAC,CAAA,iBAAA,CAAmB,CAAC,CAAA;QAEtC,OAAO,IAAI,IAAI,CAAC,KAAK,EAAE,WAAW,EAAE,GAAG,CAAC,CAAA;KACzC;;AAnDM,IAAA,CAAA,OAAO,GAAG;AACf,IAAA,SAAS,EAAE,CAAC;AACZ,IAAA,WAAW,EAAE,CAAC;AACd,IAAA,OAAO,EAAE,CAAC;AACV,IAAA,OAAO,EAAE,CAAC;CACF,CAAA;AAEH,IAAA,CAAA,KAAK,GAAG;AACb,IAAA,SAAS,EAAE,KAAK;AAChB,IAAA,WAAW,EAAE,IAAI;CACT,CAAA;AAEH,IAAA,CAAA,IAAI,GAAG;AACZ,IAAA,OAAO,EAAE,CAAC;AACV,IAAA,UAAU,EAAE,CAAC;AACb,IAAA,YAAY,EAAE,CAAC;AACf,IAAA,iBAAiB,EAAE,CAAC;AACpB,IAAA,WAAW,EAAE,EAAE;AACf,IAAA,QAAQ,EAAE,EAAE;AACZ,IAAA,GAAG,EAAE,EAAE;AACP,IAAA,gBAAgB,EAAE,EAAE;CACZ;;;;"}