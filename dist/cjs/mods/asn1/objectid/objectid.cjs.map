{"version":3,"file":"objectid.cjs","sources":["../../../../../src/mods/asn1/objectid/objectid.ts"],"sourcesContent":["import { Binary } from \"libs/binary/binary.js\"\nimport { Length } from \"mods/asn1/length/length.js\"\nimport { Type } from \"mods/asn1/type/type.js\"\n\nexport class ObjectID {\n  readonly class = ObjectID\n\n  static type = new Type(\n    Type.clazzes.UNIVERSAL,\n    Type.wraps.PRIMITIVE,\n    Type.tags.OBJECT_IDENTIFIER)\n\n  constructor(\n    readonly value: string\n  ) { }\n\n  get type() {\n    return this.class.type\n  }\n\n  toString() {\n    return `OBJECT IDENTIFIER ${this.value}`\n  }\n\n  static fromDER(binary: Binary) {\n    const type = Type.fromDER(binary)\n\n    if (!this.type.equals(type))\n      throw new Error(`Invalid type`)\n\n    const length = Length.fromDER(binary)\n    const content = binary.offset\n\n    const head = binary.readUint8()\n    const first = Math.floor(head / 40);\n    const second = head % 40;\n\n    const values = [first, second]\n\n    for (let i = 1; i < length.value; i++) {\n      const value = binary.readUint8()\n\n      if (value > 127) // TODO\n        throw new Error(`Unimplemented multi-byte OID value`)\n\n      values.push(value)\n    }\n\n    if (binary.offset - content !== length.value)\n      throw new Error(`Invalid length`)\n\n    return new this(values.join(\".\"))\n  }\n}"],"names":["type","Type","length","Length"],"mappings":";;;;;MAIa,QAAQ,CAAA;AAQnB,IAAA,WAAA,CACW,KAAa,EAAA;QAAb,IAAK,CAAA,KAAA,GAAL,KAAK,CAAQ;QARf,IAAK,CAAA,KAAA,GAAG,QAAQ,CAAA;KASpB;AAEL,IAAA,IAAI,IAAI,GAAA;AACN,QAAA,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAA;KACvB;IAED,QAAQ,GAAA;AACN,QAAA,OAAO,CAAqB,kBAAA,EAAA,IAAI,CAAC,KAAK,EAAE,CAAA;KACzC;IAED,OAAO,OAAO,CAAC,MAAc,EAAA;QAC3B,MAAMA,MAAI,GAAGC,SAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;QAEjC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAACD,MAAI,CAAC;AACzB,YAAA,MAAM,IAAI,KAAK,CAAC,CAAA,YAAA,CAAc,CAAC,CAAA;QAEjC,MAAME,QAAM,GAAGC,aAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;AACrC,QAAA,MAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAA;AAE7B,QAAA,MAAM,IAAI,GAAG,MAAM,CAAC,SAAS,EAAE,CAAA;QAC/B,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,EAAE,CAAC,CAAC;AACpC,QAAA,MAAM,MAAM,GAAG,IAAI,GAAG,EAAE,CAAC;AAEzB,QAAA,MAAM,MAAM,GAAG,CAAC,KAAK,EAAE,MAAM,CAAC,CAAA;AAE9B,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAGD,QAAM,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE;AACrC,YAAA,MAAM,KAAK,GAAG,MAAM,CAAC,SAAS,EAAE,CAAA;AAEhC,YAAA,IAAI,KAAK,GAAG,GAAG;AACb,gBAAA,MAAM,IAAI,KAAK,CAAC,CAAA,kCAAA,CAAoC,CAAC,CAAA;AAEvD,YAAA,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;AACnB,SAAA;QAED,IAAI,MAAM,CAAC,MAAM,GAAG,OAAO,KAAKA,QAAM,CAAC,KAAK;AAC1C,YAAA,MAAM,IAAI,KAAK,CAAC,CAAA,cAAA,CAAgB,CAAC,CAAA;QAEnC,OAAO,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAA;KAClC;;AA7CM,QAAI,CAAA,IAAA,GAAG,IAAID,SAAI,CACpBA,SAAI,CAAC,OAAO,CAAC,SAAS,EACtBA,SAAI,CAAC,KAAK,CAAC,SAAS,EACpBA,SAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC;;;;"}