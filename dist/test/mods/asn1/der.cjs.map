{"version":3,"file":"der.cjs","sources":["../../../../src/mods/asn1/der.ts"],"sourcesContent":["import { Binary } from \"libs/binary/binary.js\";\nimport { Constructed } from \"mods/asn1/constructed/constructed.js\";\nimport { Integer } from \"mods/asn1/integer/integer.js\";\nimport { ToStringable, Typed } from \"mods/asn1/object.js\";\nimport { Sequence } from \"mods/asn1/sequence/sequence.js\";\nimport { Type } from \"mods/asn1/type/type.js\";\nimport { Unknown } from \"mods/asn1/unknown/unknown.js\";\n\nexport namespace DER {\n\n  export function parse(binary: Binary): Typed & ToStringable {\n    const start = binary.offset\n    const type = Type.fromDER(binary)\n    binary.offset = start\n\n    if (type.equals(Sequence.type))\n      return Sequence.fromDER(binary, parse)\n    if (type.equals(Integer.type))\n      return Integer.fromDER(binary)\n\n    if (type.clazz === Type.clazzes.context) {\n      if (type.constructed)\n        return Constructed.fromDER(binary, parse)\n    }\n\n    return Unknown.fromDER(binary)\n  }\n\n}"],"names":["DER","type","Type","Sequence","Integer","Constructed","Unknown"],"mappings":";;;;;;;;AAQiBA,qBAoBhB;AApBD,CAAA,UAAiB,GAAG,EAAA;IAElB,SAAgB,KAAK,CAAC,MAAc,EAAA;AAClC,QAAA,MAAM,KAAK,GAAG,MAAM,CAAC,MAAM,CAAA;QAC3B,MAAMC,MAAI,GAAGC,SAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;AACjC,QAAA,MAAM,CAAC,MAAM,GAAG,KAAK,CAAA;AAErB,QAAA,IAAID,MAAI,CAAC,MAAM,CAACE,iBAAQ,CAAC,IAAI,CAAC;YAC5B,OAAOA,iBAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;AACxC,QAAA,IAAIF,MAAI,CAAC,MAAM,CAACG,eAAO,CAAC,IAAI,CAAC;AAC3B,YAAA,OAAOA,eAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;QAEhC,IAAIH,MAAI,CAAC,KAAK,KAAKC,SAAI,CAAC,OAAO,CAAC,OAAO,EAAE;YACvC,IAAID,MAAI,CAAC,WAAW;gBAClB,OAAOI,uBAAW,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;AAC5C,SAAA;AAED,QAAA,OAAOC,eAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;KAC/B;AAhBe,IAAA,GAAA,CAAA,KAAK,QAgBpB,CAAA;AAEH,CAAC,EApBgBN,WAAG,GAAHA,WAAG,KAAHA,WAAG,GAoBnB,EAAA,CAAA,CAAA;;"}