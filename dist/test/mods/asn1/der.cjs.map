{"version":3,"file":"der.cjs","sources":["../../../../src/mods/asn1/der.ts"],"sourcesContent":["import { Binary } from \"libs/binary/binary.js\";\nimport { BitString } from \"mods/asn1/bitstring/bitstring.js\";\nimport { Constructed } from \"mods/asn1/constructed/constructed.js\";\nimport { Integer } from \"mods/asn1/integer/integer.js\";\nimport { ObjectID } from \"mods/asn1/objectid/objectid.js\";\nimport { Sequence } from \"mods/asn1/sequence/sequence.js\";\nimport { Set } from \"mods/asn1/set/set.js\";\nimport { Type } from \"mods/asn1/type/type.js\";\nimport { ToStringable } from \"mods/asn1/types.js\";\nimport { Unknown } from \"mods/asn1/unknown/unknown.js\";\n\nexport namespace DER {\n\n  export function parse(binary: Binary): ToStringable {\n    const start = binary.offset\n    const type = Type.fromDER(binary)\n    binary.offset = start\n\n    if (type.equals(Integer.type))\n      return Integer.fromDER(binary)\n    if (type.equals(BitString.type))\n      return BitString.fromDER(binary)\n    if (type.equals(ObjectID.type))\n      return ObjectID.fromDER(binary)\n    if (type.equals(Sequence.type))\n      return Sequence.fromDER(binary, parse)\n    if (type.equals(Set.type))\n      return Set.fromDER(binary, parse)\n\n    if (type.clazz === Type.clazzes.universal)\n      return Unknown.fromDER(binary)\n\n    if (type.constructed)\n      return Constructed.fromDER(binary, parse)\n\n    return Unknown.fromDER(binary)\n  }\n\n}"],"names":["DER","type","Type","Integer","BitString","ObjectID","Sequence","Set","Unknown","Constructed"],"mappings":";;;;;;;;;;;AAWiBA,qBA2BhB;AA3BD,CAAA,UAAiB,GAAG,EAAA;IAElB,SAAgB,KAAK,CAAC,MAAc,EAAA;AAClC,QAAA,MAAM,KAAK,GAAG,MAAM,CAAC,MAAM,CAAA;QAC3B,MAAMC,MAAI,GAAGC,SAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;AACjC,QAAA,MAAM,CAAC,MAAM,GAAG,KAAK,CAAA;AAErB,QAAA,IAAID,MAAI,CAAC,MAAM,CAACE,eAAO,CAAC,IAAI,CAAC;AAC3B,YAAA,OAAOA,eAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;AAChC,QAAA,IAAIF,MAAI,CAAC,MAAM,CAACG,mBAAS,CAAC,IAAI,CAAC;AAC7B,YAAA,OAAOA,mBAAS,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;AAClC,QAAA,IAAIH,MAAI,CAAC,MAAM,CAACI,iBAAQ,CAAC,IAAI,CAAC;AAC5B,YAAA,OAAOA,iBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;AACjC,QAAA,IAAIJ,MAAI,CAAC,MAAM,CAACK,iBAAQ,CAAC,IAAI,CAAC;YAC5B,OAAOA,iBAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;AACxC,QAAA,IAAIL,MAAI,CAAC,MAAM,CAACM,OAAG,CAAC,IAAI,CAAC;YACvB,OAAOA,OAAG,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;QAEnC,IAAIN,MAAI,CAAC,KAAK,KAAKC,SAAI,CAAC,OAAO,CAAC,SAAS;AACvC,YAAA,OAAOM,eAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;QAEhC,IAAIP,MAAI,CAAC,WAAW;YAClB,OAAOQ,uBAAW,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;AAE3C,QAAA,OAAOD,eAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;KAC/B;AAvBe,IAAA,GAAA,CAAA,KAAK,QAuBpB,CAAA;AAEH,CAAC,EA3BgBR,WAAG,GAAHA,WAAG,KAAHA,WAAG,GA2BnB,EAAA,CAAA,CAAA;;"}