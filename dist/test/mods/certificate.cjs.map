{"version":3,"file":"certificate.cjs","sources":["../../../src/mods/certificate.ts"],"sourcesContent":["import { Binary } from \"libs/binary/binary.js\";\nimport { Type } from \"mods/asn1/type.js\";\n\nexport class PEM {\n  readonly class = PEM\n\n  static header = `-----BEGIN CERTIFICATE-----`\n  static footer = `-----END CERTIFICATE-----`\n\n  constructor(\n    readonly certificate: Certificate\n  ) { }\n\n  static from(text: string) {\n    text = text.replaceAll(`\\n`, ``)\n\n    if (!text.startsWith(this.header))\n      throw new Error(`Missing PEM header`)\n    if (!text.endsWith(this.footer))\n      throw new Error(`Missing PEM footer`)\n\n    const body = text.slice(this.header.length, -this.footer.length)\n    const binary = new Binary(Buffer.from(body, \"base64\"))\n    const certificate = Certificate.read(binary)\n\n    return new this(certificate)\n  }\n}\n\nexport class Certificate {\n  readonly class = Certificate\n\n  constructor(\n    // readonly tbsCertificate: TBSCertificate,\n    // readonly algorithmIdentifier: AlgorithmIdentifier,\n    // readonly signatureValue: Buffer0\n  ) { }\n\n  static read(binary: Binary) {\n    Type.read(binary)\n\n    return new this()\n  }\n}"],"names":["binary","Binary","Type"],"mappings":";;;;;MAGa,GAAG,CAAA;AAMd,IAAA,WAAA,CACW,WAAwB,EAAA;QAAxB,IAAW,CAAA,WAAA,GAAX,WAAW,CAAa;QAN1B,IAAK,CAAA,KAAA,GAAG,GAAG,CAAA;KAOf;IAEL,OAAO,IAAI,CAAC,IAAY,EAAA;QACtB,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAI,EAAA,CAAA,EAAE,CAAE,CAAA,CAAC,CAAA;QAEhC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC;AAC/B,YAAA,MAAM,IAAI,KAAK,CAAC,CAAA,kBAAA,CAAoB,CAAC,CAAA;QACvC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC;AAC7B,YAAA,MAAM,IAAI,KAAK,CAAC,CAAA,kBAAA,CAAoB,CAAC,CAAA;AAEvC,QAAA,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAA;AAChE,QAAA,MAAMA,QAAM,GAAG,IAAIC,aAAM,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,CAAA;QACtD,MAAM,WAAW,GAAG,WAAW,CAAC,IAAI,CAACD,QAAM,CAAC,CAAA;AAE5C,QAAA,OAAO,IAAI,IAAI,CAAC,WAAW,CAAC,CAAA;KAC7B;;AApBM,GAAM,CAAA,MAAA,GAAG,6BAA6B,CAAA;AACtC,GAAM,CAAA,MAAA,GAAG,2BAA2B,CAAA;MAsBhC,WAAW,CAAA;AAGtB,IAAA,WAAA;;;;;QAFS,IAAK,CAAA,KAAA,GAAG,WAAW,CAAA;KAMvB;IAEL,OAAO,IAAI,CAAC,MAAc,EAAA;AACxB,QAAAE,SAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;QAEjB,OAAO,IAAI,IAAI,EAAE,CAAA;KAClB;AACF;;;;;"}